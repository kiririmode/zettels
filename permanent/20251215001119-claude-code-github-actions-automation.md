---
id: 2025-12-15-001119
title: Claude Code GitHub Actions ã«ã‚ˆã‚‹é‹ç”¨è‡ªå‹•åŒ–
created: 2025-12-15 00:11:19
updated: 2025-12-15 00:11:19
tags:
  - claude
  - github-actions
  - automation
  - ci
  - observability
source:
  type: web
  ref: "https://blog.sshh.io/p/how-i-use-every-claude-code-feature"
---

## è¦ç´„ï¼ˆSummaryï¼‰

- Claude Code GitHub Actionï¼ˆGHAï¼‰ã¯ã€Cursor ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚ˆã‚ŠæŸ”è»Ÿã§ã€ãƒ•ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«å¯èƒ½ãª CI/CD ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€‚ä»»æ„ã®ãƒˆãƒªã‚¬ãƒ¼ï¼ˆSlackãƒ»Jiraãƒ»CloudWatch ã‚¢ãƒ©ãƒ¼ãƒˆï¼‰ã‹ã‚‰ PR ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã€‚
- GHA ãƒ­ã‚°ã¯å®Œå…¨ãªç›£æŸ»è¨¼è·¡ã¨ãªã‚Šã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’çµ„ç¹”ãƒ¬ãƒ™ãƒ«ã§åˆ†æã—ã€`CLAUDE.md` ã‚„ CLI ãƒ„ãƒ¼ãƒ«ã®ç¶™ç¶šçš„æ”¹å–„ã‚’å®Ÿç¾ã™ã‚‹ã€Œãƒ‡ãƒ¼ã‚¿é§†å‹•ãƒ•ãƒ©ã‚¤ãƒ›ã‚¤ãƒ¼ãƒ«ã€ã‚’æ§‹ç¯‰ã§ãã‚‹ã€‚

## æœ¬æ–‡ï¼ˆBodyï¼‰

### Claude Code GHA ã®ä½ç½®ã¥ã‘

**ä»–è£½å“ã¨ã®æ¯”è¼ƒ:**
- **Cursor ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: ãƒãƒãƒ¼ã‚¸ãƒ‰ç’°å¢ƒã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºåˆ¶é™ã‚ã‚Š
- **Codex Web UI**: ãƒ–ãƒ©ã‚¦ã‚¶ãƒ™ãƒ¼ã‚¹ã€ç›£æŸ»æ©Ÿèƒ½ãŒå¼±ã„
- **Claude Code GHA**: ãƒ•ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€æœ€å¼·ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã¨ç›£æŸ»æ€§

**GHA ã®ç‰¹å¾´:**
1. ã‚³ãƒ³ãƒ†ãƒŠç’°å¢ƒã‚’å®Œå…¨åˆ¶å¾¡
2. ã™ã¹ã¦ã®é«˜åº¦æ©Ÿèƒ½ï¼ˆHooksãƒ»MCPãƒ»Subagentsï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆ
3. å®Œå…¨ãªç›£æŸ»ãƒ­ã‚°ï¼ˆGitHub Actions ãƒ­ã‚°ï¼‰
4. ä»»æ„ã®ãƒˆãƒªã‚¬ãƒ¼ã‹ã‚‰èµ·å‹•å¯èƒ½

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹1: PR-from-Anywhere

**ã‚³ãƒ³ã‚»ãƒ—ãƒˆ:** ã‚ã‚‰ã‚†ã‚‹å ´æ‰€ã‹ã‚‰ PR ã‚’è‡ªå‹•ç”Ÿæˆ

#### ãƒˆãƒªã‚¬ãƒ¼ä¾‹

**1. Slack ã‹ã‚‰ PR ä½œæˆ:**
```
User in Slack: "@bot fix bug in user-service timeout issue"
â†“
Slack Bot â†’ GitHub Actions (repository_dispatch)
â†“
Claude Code GHA runs
â†“
PR created with fix + tests
â†“
Notification back to Slack
```

**2. Jira ãƒã‚±ãƒƒãƒˆã‹ã‚‰è‡ªå‹•å®Ÿè£…:**
```
Jira ticket created: "Add API rate limiting"
â†“
Jira webhook â†’ GitHub Actions
â†“
Claude Code reads ticket, implements feature
â†“
PR linked to Jira ticket
```

**3. CloudWatch ã‚¢ãƒ©ãƒ¼ãƒˆã‹ã‚‰è‡ªå‹•ä¿®æ­£:**
```
CloudWatch alarm: "High error rate in payment-service"
â†“
SNS â†’ Lambda â†’ GitHub Actions
â†“
Claude Code analyzes logs, fixes bug
â†“
PR with hotfix + rollback plan
```

#### å®Ÿè£…ä¾‹

**GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:**
```yaml
# .github/workflows/claude-pr-bot.yml
name: Claude PR Bot

on:
  repository_dispatch:
    types: [create-pr-from-slack, create-pr-from-jira, hotfix-from-alert]

jobs:
  claude-code:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Claude Code
        uses: anthropics/claude-code-action@v1
        with:
          anthropic-api-key: ${{ secrets.ANTHROPIC_API_KEY }}
      
      - name: Run Claude Code
        run: |
          claude -p "${{ github.event.client_payload.prompt }}" \
                 --context="${{ github.event.client_payload.context }}"
      
      - name: Create PR
        uses: peter-evans/create-pull-request@v5
        with:
          title: "[Auto] ${{ github.event.client_payload.title }}"
          body: |
            ğŸ¤– Auto-generated by Claude Code
            
            **Trigger:** ${{ github.event.action }}
            **Context:** ${{ github.event.client_payload.context }}
            
            **Changes:**
            ${{ steps.claude-code.outputs.summary }}
            
            **Logs:** [View full logs](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})
          branch: auto/${{ github.event.client_payload.branch-name }}
          labels: automated, needs-review
```

**Slack ãƒœãƒƒãƒˆã‹ã‚‰ã®ãƒˆãƒªã‚¬ãƒ¼:**
```javascript
// slack-bot.js
const { Octokit } = require('@octokit/rest');

async function triggerClaudeBot(slackMessage) {
  const octokit = new Octokit({ auth: process.env.GITHUB_TOKEN });
  
  await octokit.repos.createDispatchEvent({
    owner: 'your-org',
    repo: 'your-repo',
    event_type: 'create-pr-from-slack',
    client_payload: {
      prompt: slackMessage.text,
      title: `Fix requested by ${slackMessage.user}`,
      context: {
        user: slackMessage.user,
        channel: slackMessage.channel,
        timestamp: slackMessage.ts
      },
      branchName: `slack-${Date.now()}`
    }
  });
  
  return "âœ… Claude is working on it! You'll be notified when PR is ready.";
}
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹2: ãƒ‡ãƒ¼ã‚¿é§†å‹•ãƒ•ãƒ©ã‚¤ãƒ›ã‚¤ãƒ¼ãƒ«

**ã‚³ãƒ³ã‚»ãƒ—ãƒˆ:** GHA ãƒ­ã‚°ã‚’åˆ†æã—ã€çµ„ç¹”å…¨ä½“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå“è³ªã‚’ç¶™ç¶šçš„ã«æ”¹å–„

#### ãƒ•ãƒ©ã‚¤ãƒ›ã‚¤ãƒ¼ãƒ«ã®ä»•çµ„ã¿

```mermaid
flowchart TB
    A["ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ<br/>(GHA)"] --> B["ãƒ­ã‚°åé›†<br/>(å®Œå…¨ãªç›£æŸ»è¨¼è·¡)"]
    B --> C["å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ"]
    C --> D["æ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³"]
    
    D --> E1["CLAUDE.md æ›´æ–°<br/>(ã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«è¿½åŠ )"]
    D --> E2["CLI ãƒ„ãƒ¼ãƒ«æ”¹å–„<br/>(ã‚¨ãƒ©ãƒ¼å‰Šæ¸›)"]
    D --> E3["Hooks è¿½åŠ <br/>(æ¤œè¨¼å¼·åŒ–)"]
    
    E1 --> A
    E2 --> A
    E3 --> A
    
    style C fill:#ff9
    style D fill:#9f9
```

#### å®Ÿè£…ä¾‹

**ãƒ­ã‚°åˆ†æã‚¹ã‚¯ãƒªãƒ—ãƒˆ:**
```bash
#!/bin/bash
# analyze-claude-logs.sh

# éå»5æ—¥é–“ã® GHA ãƒ­ã‚°ã‚’å–å¾—
gh run list --workflow=claude-pr-bot.yml \
            --limit=100 \
            --json conclusion,databaseId,createdAt > runs.json

# å¤±æ•—ã—ãŸãƒ­ã‚°ã‚’æŠ½å‡º
jq -r '.[] | select(.conclusion=="failure") | .databaseId' runs.json | \
while read run_id; do
  gh run view "$run_id" --log > "logs/failed-$run_id.log"
done

# ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é›†è¨ˆ
grep -h "Error:" logs/failed-*.log | \
  sort | uniq -c | sort -rn > error-patterns.txt

echo "Top 10 error patterns:"
head -10 error-patterns.txt
```

**è‡ªå‹•æ”¹å–„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:**
```yaml
# .github/workflows/improve-agent.yml
name: Improve Agent Config

on:
  schedule:
    - cron: '0 0 * * 0'  # æ¯é€±æ—¥æ›œæ—¥

jobs:
  analyze-and-improve:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Analyze logs
        run: ./scripts/analyze-claude-logs.sh
      
      - name: Generate improvements
        run: |
          claude -p "
            Analyze error-patterns.txt and suggest improvements to:
            1. CLAUDE.md (add guardrails for common mistakes)
            2. CLI tools (improve error messages)
            3. Hooks (add validation for common failures)
            
            Create a PR with your suggestions.
          "
      
      - name: Create improvement PR
        uses: peter-evans/create-pull-request@v5
        with:
          title: "[Weekly] Agent configuration improvements"
          body: "Auto-generated improvements based on last week's failures"
```

#### åˆ†æä¾‹

**ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³åé›†:**
```
# error-patterns.txt
  45 Error: Tests failed - ModuleNotFoundError: No module named 'pytest'
  32 Error: Commit blocked - /tmp/tests-passed not found
  28 Error: Permission denied: .github/workflows/
  15 Error: Timeout: Command took longer than 300s
  12 Error: Invalid YAML in config file
```

**æ”¹å–„ææ¡ˆï¼ˆClaude ãŒç”Ÿæˆï¼‰:**
```markdown
# Improvement PR

## Analysis
Analyzed 100 runs, found 45 failures due to missing pytest.

## Proposed Changes

### 1. CLAUDE.md
Add to testing section:
```markdown
## Python Testing
- ALWAYS check if pytest is installed: `pip list | grep pytest`
- If missing, install: `pip install pytest`
```

### 2. test.sh script
Add automatic pytest installation:
```bash
if ! pip list | grep -q pytest; then
  echo "Installing pytest..."
  pip install pytest
fi
```
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹3: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹

**GHA ã®åˆ©ç‚¹:**
- å®Œå…¨ã«éš”é›¢ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠç’°å¢ƒ
- ç´°ã‹ã„ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³åˆ¶å¾¡
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šä¾‹:**
```yaml
jobs:
  claude-code:
    runs-on: ubuntu-latest
    
    # ã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–
    container:
      image: custom-claude-sandbox:latest
      options: --cpus=2 --memory=4g
    
    # æœ€å°æ¨©é™
    permissions:
      contents: read
      pull-requests: write
    
    # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ¶é™
    env:
      HTTPS_PROXY: http://internal-proxy:3128
      NO_PROXY: github.com,api.anthropic.com
    
    # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
    timeout-minutes: 30
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹4: PR ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦ä»¶

**å“²å­¦çš„ãªå•é¡Œ:**
> é¡§å®¢ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰ç›´æ¥ç”Ÿæˆã•ã‚ŒãŸ PR ã¯ã€äººé–“ã®ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãŒä½•äººå¿…è¦ã‹ï¼Ÿ

**ç¾åœ¨ã®å®Ÿè·µ:**
- **äººé–“ãŒæŒ‡ç¤ºã—ãŸ PR**: 1äººã®ãƒ¬ãƒ“ãƒ¥ã‚¢
- **AI ãŒç›´æ¥ä½œæˆã—ãŸ PR**: **2äººã®ãƒ¬ãƒ“ãƒ¥ã‚¢** âœ…

**ç†ç”±:**
1. äººé–“ã®æ„å›³ãŒä»‹åœ¨ã—ã¦ã„ãªã„
2. ã‚ˆã‚Šæ…é‡ãªæ¤œè¨¼ãŒå¿…è¦
3. ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®è¦‹è½ã¨ã—ãƒªã‚¹ã‚¯

**å°†æ¥ã®æ–¹å‘æ€§:**
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä¿¡é ¼æ€§ãŒå‘ä¸Šã™ã‚Œã° 1äººã«å‰Šæ¸›
- è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ 95% ä»¥ä¸Šãªã‚‰è‡ªå‹•ãƒãƒ¼ã‚¸ã‚‚æ¤œè¨

### å®Ÿè·µãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Claude Code GHA ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¨­å®šã—ãŸã‹ï¼Ÿ
- [ ] å¤–éƒ¨ãƒˆãƒªã‚¬ãƒ¼ï¼ˆSlackãƒ»Jira ãªã©ï¼‰ã‚’çµ±åˆã—ãŸã‹ï¼Ÿ
- [ ] ãƒ­ã‚°åˆ†æã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®šæœŸå®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚’é©ç”¨ã—ãŸã‹ï¼Ÿ
- [ ] AIç”Ÿæˆ PR ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®šç¾©ã—ãŸã‹ï¼Ÿ

### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

âŒ **ç„¡åˆ¶é™ã®æ¨©é™**
```yaml
permissions: write-all  # å±é™º
```

âŒ **ãƒ­ã‚°åˆ†æã®æ”¾ç½®**
```
# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒåŒã˜ã‚¨ãƒ©ãƒ¼ã‚’æ¯é€±ç¹°ã‚Šè¿”ã™
```

âŒ **ãƒ¬ãƒ“ãƒ¥ãƒ¼ãªã—ã®è‡ªå‹•ãƒãƒ¼ã‚¸**
```yaml
- name: Auto merge
  run: gh pr merge --auto --squash  # ãƒªã‚¹ã‚¯å¤§
```

## é–¢é€£ãƒãƒ¼ãƒˆï¼ˆLinksï¼‰

- [[20251215000637-claude-code-sdk-usage-patterns|Claude Code SDK ã®3ã¤ã®æ´»ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³]]
- [[20251215000015-block-at-submit-hook-strategy|Block-at-Submitãƒ•ãƒƒã‚¯æˆ¦ç•¥]]
- [[20251129165841-ai-agent-end-to-end-testing|AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãŠã‘ã‚‹ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ]]
- [[20251206-123000-claude-code-agentic-coding-workflows|ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçš„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã‚¹ã‚±ãƒ¼ãƒ«]]

## To-Do / æ¬¡ã«è€ƒãˆã‚‹ã“ã¨

- [ ] Slack ã‹ã‚‰ PR ã‚’ä½œæˆã™ã‚‹ PoC ã‚’æ§‹ç¯‰
- [ ] é€±æ¬¡ã§ãƒ­ã‚°ã‚’åˆ†æã—ã€`CLAUDE.md` ã‚’è‡ªå‹•æ”¹å–„ã™ã‚‹ä»•çµ„ã¿ã‚’ä½œã‚‹
- [ ] AIç”Ÿæˆ PR ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’æ–‡æ›¸åŒ–
